import{r as i,a0 as S,j as f,z as b,d as y,e as v}from"./index-CAkiVclH.js";var I=Symbol.for("react.lazy"),p=S[" use ".trim().toString()];function T(e){return typeof e=="object"&&e!==null&&"then"in e}function m(e){return e!=null&&typeof e=="object"&&"$$typeof"in e&&e.$$typeof===I&&"_payload"in e&&T(e._payload)}function _(e){const t=E(e),r=i.forwardRef((n,o)=>{let{children:s,...a}=n;m(s)&&typeof p=="function"&&(s=p(s._payload));const c=i.Children.toArray(s),u=c.find(N);if(u){const d=u.props.children,h=c.map(g=>g===u?i.Children.count(d)>1?i.Children.only(null):i.isValidElement(d)?d.props.children:null:g);return f.jsx(t,{...a,ref:o,children:i.isValidElement(d)?i.cloneElement(d,void 0,h):null})}return f.jsx(t,{...a,ref:o,children:s})});return r.displayName=`${e}.Slot`,r}var O=_("Slot");function E(e){const t=i.forwardRef((r,n)=>{let{children:o,...s}=r;if(m(o)&&typeof p=="function"&&(o=p(o._payload)),i.isValidElement(o)){const a=R(o),c=C(s,o.props);return o.type!==i.Fragment&&(c.ref=n?b(n,a):a),i.cloneElement(o,c)}return i.Children.count(o)>1?i.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var x=Symbol("radix.slottable");function N(e){return i.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===x}function C(e,t){const r={...t};for(const n in t){const o=e[n],s=t[n];/^on[A-Z]/.test(n)?o&&s?r[n]=(...c)=>{const u=s(...c);return o(...c),u}:o&&(r[n]=o):n==="style"?r[n]={...o,...s}:n==="className"&&(r[n]=[o,s].filter(Boolean).join(" "))}return{...e,...r}}function R(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}const w=v("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover-elevate active-elevate-2",{variants:{variant:{default:"bg-primary text-primary-foreground border border-primary-border",destructive:"bg-destructive text-destructive-foreground shadow-sm border-destructive-border",outline:" border [border-color:var(--button-outline)] shadow-xs active:shadow-none ",secondary:"border bg-secondary text-secondary-foreground border border-secondary-border ",ghost:"border border-transparent",link:"text-primary underline-offset-4 hover:underline"},size:{default:"min-h-9 px-4 py-2",sm:"min-h-8 rounded-md px-3 text-xs",lg:"min-h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),P=i.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...o},s)=>{const a=n?O:"button";return f.jsx(a,{className:y(w({variant:t,size:r,className:e})),ref:s,...o})});P.displayName="Button";const A=i.forwardRef(({className:e,type:t,...r},n)=>f.jsx("input",{type:t,className:y("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));A.displayName="Input";const k="/api";class ${constructor(){this.token=null}setToken(t){this.token=t,localStorage.setItem("auth_token",t)}getToken(){return this.token||(this.token=localStorage.getItem("auth_token")),this.token}clearToken(){this.token=null,localStorage.removeItem("auth_token")}async request(t,r={}){const n=this.getToken(),o={"Content-Type":"application/json",...r.headers};n&&(o.Authorization=`Bearer ${n}`);const s=await fetch(`${k}${t}`,{...r,headers:o});if(!s.ok){const a=await s.json().catch(()=>({error:"Error desconocido"}));throw new Error(a.error||`HTTP ${s.status}`)}return s.json()}async login(t,r){const n=await this.request("/auth/login",{method:"POST",body:JSON.stringify({username:t,password:r})});return this.setToken(n.token),n}async bootstrap(){return this.request("/me/bootstrap")}async syncPush(t){return this.request("/sync/push",{method:"POST",body:JSON.stringify({events:t})})}async getVentas(t){const r=new URLSearchParams;t?.rutaId&&r.set("rutaId",t.rutaId.toString()),t?.clienteId&&r.set("clienteId",t.clienteId.toString()),t?.limit&&r.set("limit",t.limit.toString());const n=r.toString();return this.request(`/ventas${n?`?${n}`:""}`)}async getDescuentos(){return this.request("/descuentos")}async createDescuento(t,r,n,o){return this.request("/descuentos",{method:"POST",body:JSON.stringify({clienteId:o||null,productoId:t,tipoDescuento:r,tiers:n})})}async deleteDescuento(t){return this.request(`/descuentos/${t}`,{method:"DELETE"})}async getRutas(){return this.request("/rutas")}async getClientes(t){const r=t?`?rutaId=${t}`:"";return this.request(`/clientes${r}`)}async getProductos(){return this.request("/productos")}async getMovimientos(){return this.request("/movimientos")}async getMovimientosRuta(t,r,n){let o=`/movimientos/ruta/${t}`;const s=new URLSearchParams;return r&&s.append("fechaDesde",r),n&&s.append("fechaHasta",n),s.toString()&&(o+=`?${s.toString()}`),this.request(o)}}const j=new $,l={BOOTSTRAP:"vr_offline_bootstrap",CLIENTES:"vr_offline_clientes",PRODUCTOS:"vr_offline_productos",INVENTARIO:"vr_offline_inventario",INVENTARIO_MIXTO:"vr_offline_inventario_mixto",LAST_SYNC:"vr_offline_last_sync"};function L(e){try{localStorage.setItem(l.BOOTSTRAP,JSON.stringify(e)),localStorage.setItem(l.CLIENTES,JSON.stringify(e.clientes)),localStorage.setItem(l.PRODUCTOS,JSON.stringify(e.productos)),localStorage.setItem(l.INVENTARIO,JSON.stringify(e.inventario)),e.inventarioMixto&&localStorage.setItem(l.INVENTARIO_MIXTO,JSON.stringify(e.inventarioMixto)),localStorage.setItem(l.LAST_SYNC,new Date().toISOString())}catch(t){console.error("Error saving bootstrap to cache:",t)}}function V(){try{const e=localStorage.getItem(l.BOOTSTRAP);return e?JSON.parse(e):null}catch{return null}}function B(){try{const e=localStorage.getItem(l.CLIENTES);return e?JSON.parse(e):[]}catch{return[]}}function D(){return localStorage.getItem(l.LAST_SYNC)}export{P as B,A as I,O as S,j as a,V as b,_ as c,D as d,B as g,L as s};
