import{a as l}from"./api-BvF3Zc_M.js";function m(t){return{id:t.id,clienteId:t.clienteId,productoId:t.productoId,mode:t.tipoDescuento,tiers:t.tiers.map(n=>({minQty:parseFloat(n.volumenDesde),discountAmount:parseFloat(n.descuentoMonto)})),active:t.activo,clienteNombre:t.clienteNombre,productoNombre:t.productoNombre}}async function D(){try{return(await l.getDescuentos()).rules.map(m)}catch{return[]}}async function A(t){try{const n=t.tiers.map(o=>({volumenDesde:o.minQty.toFixed(3),descuentoMonto:o.discountAmount.toFixed(2)})),s=await l.createDescuento(t.productoId,t.mode,n,t.clienteId);return m(s.rule)}catch{return null}}async function h(t){try{return await l.deleteDescuento(t),!0}catch{return!1}}function b(t,n,s,o,a="PIEZA"){const i=t.filter(e=>e.active&&e.productoId===s&&(e.mode===a||e.mode==="MIXTO")&&(e.clienteId===null||e.clienteId===n));if(i.length===0)return null;const d=i.filter(e=>e.clienteId===n),f=i.filter(e=>e.clienteId===null),p=d.length>0?d:f;let c=null;for(const e of p){const u=[...e.tiers].sort((r,I)=>I.minQty-r.minQty).find(r=>o>=r.minQty);u&&(!c||u.discountAmount>c.discountAmount)&&(c={discountAmount:u.discountAmount,mode:e.mode})}return c}export{b as a,A as c,h as d,D as f};
